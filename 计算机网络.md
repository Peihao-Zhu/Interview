# 1 基础

## 1.1 ★★★ 各层协议的作用，以及 TCP/IP 协议的特点。	

![img](file:////private/var/folders/gw/tm5w3wzx75b28wcz_7klvkxm0000gn/T/com.kingsoft.wpsoffice.mac/wps-zhupeihao/ksohtml/wpsvMjgoL.jpg)

####  五层协议

- 应用层：为特定应用程序提供数据传输服务，如HTTP、DNS。数据单位为报文
- 传输层：为进程提供通用数据传输服务。运输层包括两种协议：传输控制协议TCP，提供面向连接、可靠的数据传输服务，数据单位为报文段；用户数据报协议UDP，提供无连接、尽最大努力的数据传输服务，数据单位为用户数据报。TCP提供完整性服务，UDP提供及时性服务。
- 网络层：为主机提供数据传输服务。把传输层传下来的报文段或者用户数据报封装成分组
- 数据链路层：主机之间有很多链路，链路层协议就是同一链路的主机提供数据传输服务
- 物理层：怎样在传输媒体上传输数据比特流，而不是具体的传输媒体。物理层的作用是尽可能屏蔽传输媒体和通信手段的差异

#### TCP/IP协议的特点

https://blog.csdn.net/qq_33857502/article/details/57414162

（1）TCP/IP协议不依赖于任何特定的计算机硬件或操作系统，提供开放的协议标准，即使不考虑Internet，TCP/IP协议也获得了广泛的支持。所以TCP/IP协议成为一种联合各种硬件和软件的实用系统。

（2）TCP/IP协议并不依赖于特定的网络传输硬件，所以TCP/IP协议能够集成各种各样的网络。用户能够使用以太网（Ethernet）、[令牌环网](http://baike.baidu.com/view/115033.htm)（Token Ring Network）、拨号线路（Dial-up line）、[X.25](http://baike.baidu.com/view/175390.htm)网以及所有的网络传输硬件。

（3）统一的网络地址分配方案，使得整个TCP/IP设备在网中都具有惟一的地址

（4）标准化的高层协议，可以提供多种可靠的用户服务。

## 1.2 ★★☆ 以太网的特点，以及帧结构。	

以太网是一种星型拓扑结构的***\*局域网\****，早期使用集线器进行连接，作用于比特而不是帧，当一个比特到达接口时，集线器生成该比特并将其强度放大，从而扩大网络距离。

 

现在以太网使用交换机替代了集线器，交换机是一种链路层设备，不会发生碰撞，会根据MAC地址进行存储转发

![img](file:////private/var/folders/gw/tm5w3wzx75b28wcz_7klvkxm0000gn/T/com.kingsoft.wpsoffice.mac/wps-zhupeihao/ksohtml/wpsi4HsWs.jpg) 

- 类型：标记上层使用的协议
- 数据：长度在46-1500之间
- FCS：帧检验序列，使用CRC（循环冗余）检验

## 1.3 ★★☆ 集线器、交换机、路由器的作用，以及所属的网络层。	

https://blog.csdn.net/clubsondy/article/details/542615

 

**集线器：**

物理层

没有智能处理能力，数据只是电流而已，当一个端口的电流传到集线器中时，只是简单的将电流传送到其他端口，至于其他端口连接的计算机接不接收就不管了。

共享性模式，就是一个端口在向另一个端口发送数据是，其他端口处于等待状态。

 

**交换器：**

链路层

具有自学习能力，学习得是交换表的内容，交换表中存储着MAC地址到接口的映射。因为是自学习，所以交换机是一种即插即吧设备，不需要管理员手动配置交换表内容。

下图：交换机有4个接口，主机A向主机B发送数据帧时，交换机把主机A的MAC的地址和接口1的映射写入交换表，此时没有主机B的表项，所以主机A发送广播帧，主机C和主机D会丢弃该帧，主机B回应该帧向A发送数据包时，交换机查找交换表得到主机A映射的接口为1，发送数据到接口1，同时在交换表中添加主机B的MAC地址到接口2的映射。

![img](file:////private/var/folders/gw/tm5w3wzx75b28wcz_7klvkxm0000gn/T/com.kingsoft.wpsoffice.mac/wps-zhupeihao/ksohtml/wpsqd1GT5.jpg) 

 

**路由器：**

工作在网络层，能够连接不同类型的网络，能够选择数据传送的路径。能理解数据中的IP地址，如果接收到一个数据包，就检查其中的IP地址，如果目标地址是本地网络，就不理会，如果是其他网络，就会讲数据包转发出本地网络。

集线器和交换机一般用于连接以太网，路由器可以连接不同类型的局域网，广域网。不同类型的网络，传送的数据单元-帧的格式大小也不同。

路由器有路径选择能力，从一个节点到另一个节点有不同的路由算法。

## 1.4 ★★☆ IP 数据数据报常见字段的作用。	

![img](file:////private/var/folders/gw/tm5w3wzx75b28wcz_7klvkxm0000gn/T/com.kingsoft.wpsoffice.mac/wps-zhupeihao/ksohtml/wpsmLk9gI.png) 

- 版本：IPv4和IPv6
- 首部长度：占4个位，最大值位15.值为1表示1个32位长度，也就是4字节。因为固定部分长度位20字节，所以该值最小位5
- 区分服务：用来获得更好的服务，一般不用
- 总长度，包括首部长度和数据部分长度
- 生存时间TLL：防止无法交付的数据报在互联网中不断兜圈子。以路由器跳数位单位，当TLL为0就丢弃数据包。
- 协议：携带的数据上交给哪个协议进行处理，如ICMP、TCP、UDP。
- 首部检验和：数据包每经过一个路由器，都要重新计算检验和，检验和不包含数据部分可以减少计算量
- 标识：在数据报过长而发生分片情况下，相同数据报的不同分片具有相同的标识符
- 片偏移：和标识符一起，用于发生分片的情况。单位是8字节。

![img](file:////private/var/folders/gw/tm5w3wzx75b28wcz_7klvkxm0000gn/T/com.kingsoft.wpsoffice.mac/wps-zhupeihao/ksohtml/wpsNcZp1d.jpg) 

## 1.5 ★☆☆ ARP 协议的作用，以及维护 ARP 缓存的过程。

## 1.6 ★★☆ ICMP 报文种类以及作用；和 IP 数据报的关系；Ping 和 Traceroute 的具体原理。	

## 1.7 ★★★ UDP 与 TCP 比较，分析上层协议应该使用 UDP 还是 TCP。	

## 1.8 ★★★ 理解三次握手以及四次挥手具体过程，三次握手的原因、四次挥手原因、TIME_WAIT 的作用。

## 1.9 ★★★ 可靠传输原理，并设计可靠 UDP 协议	

## 1.10 ★★☆ TCP 拥塞控制的作用，理解具体原理。

## 1.11 ★★☆ DNS 的端口号；TCP 还是 UDP；作为缓存、负载均衡。	

## 1.12 ★★☆ TCP如何实现流量控制	



# 2 HTTP

## 2.1 ★★★ GET 与 POST 比较：作用、参数、安全性、幂等性、可缓存。

## 2.2 ★★☆ HTTP 状态码。

## 2.3 ★★★ Cookie 作用、安全性问题、和 Session 的比较。

## 2.4 ★★☆ 缓存 的 Cache-Control 字段，特别是 Expires 和 max-age 的区别。ETag 验证原理。

## 2.5 ★★★ 长连接与短连接原理以及使用场景，流水线。

## 2.6 ★★★ HTTP 存在的安全性问题，和HTTPS的区别以及 HTTPs 的加密、认证和完整性保护作用。

## 2.7 ★★☆ HTTP/1.x 的缺陷，以及 HTTP/2 的特点。

## 2.8 ★★★ HTTP/1.1 的特性。

## 2.9 ★★☆ HTTP 与 FTP 的比较。

# 3 Socket

## 3.1 ★★☆ 五种 IO 模型的特点以及比较。

# 3.2 ★★★ select、poll、epoll 的原理、比较、以及使用场景；epoll 的水平触发与边缘触发。

IO多路复用（IO Multiplexing）是指单个进程/线程就可以同时处理多个IO请求。

实现原理：用户将想要监视的文件描述符（File Descriptor）添加到select/poll/epoll函数中，由内核监视，函数阻塞。一旦有文件描述符就绪（读就绪或写就绪），或者超时（设置timeout），函数就会返回，然后该进程可以进行相应的读/写操作。

<details>
<summary>select/poll/epoll三者的区别？</summary>


- ```select```：将文件描述符放入一个集合中，调用select时，将这个集合从用户空间拷贝到内核空间（缺点1：每次都要复制，**开销大**），由内核根据就绪状态修改该集合的内容。（缺点2）**集合大小有限制**，32位机默认是1024（64位：2048）；采用水平触发机制。select函数返回后，需要通过遍历这个集合，找到就绪的文件描述符（缺点3：**轮询的方式效率较低**），当文件描述符的数量增加时，效率会线性下降；
- ```poll```：和select几乎没有区别，区别在于文件描述符的存储方式不同，poll采用链表的方式存储，没有最大存储数量的限制；
- ```epoll```：通过内核和用户空间共享内存，避免了不断复制的问题；支持的同时连接数上限很高（1G左右的内存支持10W左右的连接数）；文件描述符就绪时，采用回调机制，避免了轮询（回调函数将就绪的描述符添加到一个链表中，执行epoll_wait时，返回这个链表）；支持水平触发和边缘触发，采用边缘触发机制时，只有活跃的描述符才会触发回调函数。

总结，区别主要在于：

- 一个线程/进程所能打开的最大连接数
- 文件描述符传递方式（是否复制）
- 水平触发 or 边缘触发
- 查询就绪的描述符时的效率（是否轮询）

#### 什么时候使用select/poll，什么时候使用epoll？

当连接数较多并且有很多的不活跃连接时，epoll的效率比其它两者高很多；但是当连接数较少并且都十分活跃的情况下，由于epoll需要很多回调，因此性能可能低于其它两者。

#### 什么是文件描述符？

文件描述符在形式上是一个非负整数。实际上，它是一个索引值，指向内核为每一个进程所维护的该进程打开文件的记录表。当程序打开一个现有文件或者创建一个新文件时，内核向进程返回一个文件描述符。

内核通过文件描述符来访问文件。文件描述符指向一个文件。

#### 什么是水平触发？什么是边缘触发？

- 水平触发（LT，Level Trigger）模式下，只要一个文件描述符就绪，就会触发通知，如果用户程序没有一次性把数据读写完，下次还会通知；
- 边缘触发（ET，Edge Trigger）模式下，当描述符从未就绪变为就绪时通知一次，之后不会再通知，直到再次从未就绪变为就绪（缓冲区从不可读/写变为可读/写）。
- 区别：边缘触发效率更高，减少了被重复触发的次数，函数不会返回大量用户程序可能不需要的文件描述符。
- 为什么边缘触发一定要用非阻塞（non-block）IO：避免由于一个描述符的阻塞读/阻塞写操作让处理其它描述符的任务出现饥饿状态。

#### 有哪些常见的IO模型？

- 同步阻塞IO（Blocking IO）：用户线程发起IO读/写操作之后，线程阻塞，直到可以开始处理数据；对CPU资源的利用率不够；
- 同步非阻塞IO（Non-blocking IO）：发起IO请求之后可以立即返回，如果没有就绪的数据，需要不断地发起IO请求直到数据就绪；不断重复请求消耗了大量的CPU资源；
- IO多路复用
- 异步IO（Asynchronous IO）：用户线程发出IO请求之后，继续执行，由内核进行数据的读取并放在用户指定的缓冲区内，在IO完成之后通知用户线程直接使用。